# 📱 تحليل الشاشات التفصيلي - ليدززز (Leedz)

> **الإصدار:** 2.1.0  
> **تاريخ التحديث:** يناير 2026  
> **الحالة:** 23 شاشة (17 موجودة + 6 SaaS مخططة)

---

## 📋 فهرس الشاشات

### الشاشات الموجودة (Existing - 17 شاشة)

| # | الشاشة | الملف | المسار | الصلاحية | الحالة |
|---|--------|-------|--------|----------|--------|
| 1 | تسجيل الدخول | `LoginPage.tsx` | `/login` | عام | ✅ موجود |
| 2 | استعادة المرور | `ForgotPasswordPage.tsx` | `/forgot-password` | عام | ✅ موجود |
| 3 | لوحة التحكم | `DashboardPage.tsx` | `/app/dashboard` | مسجل | ✅ موجود |
| 4 | البحث عن عملاء | `ProspectingPage.tsx` | `/app/prospecting` | مسجل | ✅ موجود |
| 5 | إدارة العملاء | `LeadsManagementPage.tsx` | `/app/leads` | مسجل | ✅ موجود |
| 6 | إضافة عميل | `NewLeadPage.tsx` | `/app/leads/new` | مسجل | ✅ موجود |
| 7 | استيراد عملاء | `LeadImportPage.tsx` | `/app/leads/import` | مسجل | ✅ موجود |
| 8 | تفاصيل العميل | `LeadDetailPage.tsx` | `/app/leads/:id` | مسجل | ✅ موجود |
| 9 | تفاصيل الشركة | `CompanyDetailPage.tsx` | `/app/companies/:id` | مسجل | ✅ موجود |
| 10 | القوائم | `ListsPage.tsx` | `/app/lists` | مسجل | ✅ موجود |
| 11 | تفاصيل القائمة | `ListDetailPage.tsx` | `/app/lists/:id` | مسجل | ✅ موجود |
| 12 | إدارة واتساب | `WhatsAppMessagesPage.tsx` | `/app/whatsapp` | مسجل | ✅ موجود |
| 13 | إدارة الفريق | `TeamPage.tsx` | `/app/team` | ADMIN | ✅ موجود |
| 14 | التكاملات | `IntegrationsPage.tsx` | `/app/integrations` | ADMIN | ✅ موجود |
| 15 | سجل الرقابة | `AuditLogsPage.tsx` | `/app/audit-logs` | ADMIN | ✅ موجود |
| 16 | الإعدادات | `SettingsPage.tsx` | `/app/settings` | مسجل | ✅ موجود |
| 17 | إضافة المتصفح | `ExtensionSidePanel.tsx` | `/extension-preview` | عام | ✅ موجود |

### شاشات SaaS المخططة (Planned - 6 شاشات)

| # | الشاشة | الملف | المسار | الصلاحية | الحالة |
|---|--------|-------|--------|----------|--------|
| 18 | التسجيل | `SignupPage.tsx` | `/signup` | عام | 📋 Planned |
| 19 | التأهيل | `OnboardingPage.tsx` | `/onboarding` | مسجل | 📋 Planned |
| 20 | تبديل المنظمة | `SwitchTenantPage.tsx` | `/switch-tenant` | مسجل | 📋 Planned |
| 21 | الاشتراك | `BillingPage.tsx` | `/app/billing` | OWNER | 📋 Planned |
| 22 | الاستخدام | `UsagePage.tsx` | `/app/usage` | ADMIN+ | 📋 Planned |
| 23 | إعدادات الأمان | `SecuritySettingsPage.tsx` | `/app/settings/security` | مسجل | 📋 Planned |

> **ملاحظة:** الشاشات المخططة (Planned) موثقة بالكامل أدناه مع DoD للتنفيذ. لا تتطلب تغييرات في الشاشات الموجودة.

---

## 1️⃣ شاشة تسجيل الدخول (Login)

### المعلومات الأساسية
- **الملف:** `LoginPage.tsx`
- **المسار:** `/login`
- **التخطيط:** شاشة كاملة بدون AppShell

### التصميم
```
┌─────────────────────────────────────────────────────────────┐
│                                                             │
│  ┌─────────────────────┐  ┌─────────────────────────────┐  │
│  │                     │  │                             │  │
│  │   الجانب المرئي     │  │      نموذج تسجيل الدخول     │  │
│  │   (Visual Side)     │  │                             │  │
│  │                     │  │   - البريد الإلكتروني       │  │
│  │   - شعار ليدززز     │  │   - كلمة المرور             │  │
│  │   - العنوان الرئيسي │  │   - زر الدخول               │  │
│  │   - الوصف           │  │   - روابط مساعدة            │  │
│  │   - شارة الأمان     │  │                             │  │
│  │                     │  │                             │  │
│  └─────────────────────┘  └─────────────────────────────┘  │
│                                                             │
└─────────────────────────────────────────────────────────────┘
```

### العناصر
| العنصر | النوع | الوظيفة |
|--------|-------|---------|
| شعار ليدززز | عرض | هوية العلامة التجارية |
| حقل البريد | input[email] | إدخال البريد الإلكتروني |
| حقل كلمة المرور | input[password] | إدخال كلمة المرور |
| زر الدخول | button[submit] | تنفيذ تسجيل الدخول |
| رابط نسيت كلمة المرور | link | الانتقال لاستعادة المرور |
| روابط التذييل | links | سياسة الخصوصية، الشروط، الدعم |

### السلوك
1. عند الضغط على "ابدأ العمل الآن":
   - عرض مؤشر تحميل (Loader)
   - محاكاة المصادقة (1.5 ثانية)
   - التوجيه إلى `/app/dashboard`

### الحالات
- **افتراضي:** النموذج فارغ
- **تحميل:** زر معطل مع spinner
- **خطأ:** (غير مُنفذ حالياً)

---

## 2️⃣ شاشة استعادة المرور (Forgot Password)

### المعلومات الأساسية
- **الملف:** `ForgotPasswordPage.tsx`
- **المسار:** `/forgot-password`
- **التخطيط:** شاشة كاملة بدون AppShell

### العناصر
| العنصر | النوع | الوظيفة |
|--------|-------|---------|
| رابط العودة | link | العودة لتسجيل الدخول |
| حقل البريد | input[email] | إدخال البريد المسجل |
| زر الإرسال | button[submit] | إرسال رابط الاستعادة |

### الحالات
- **إدخال:** عرض النموذج
- **تحميل:** زر معطل مع spinner
- **نجاح:** عرض رسالة تأكيد مع أيقونة ✓

---

## 3️⃣ لوحة التحكم (Dashboard)

### المعلومات الأساسية
- **الملف:** `DashboardPage.tsx`
- **المسار:** `/app/dashboard`
- **التخطيط:** داخل AppShell

### التصميم
```
┌─────────────────────────────────────────────────────────────┐
│  العنوان: لوحة التحكم التنفيذية          [تصفية] [بحث جديد] │
├─────────────────────────────────────────────────────────────┤
│  ┌──────┐ ┌──────┐ ┌──────┐ ┌──────┐                       │
│  │عملاء │ │أدلة  │ │رسائل │ │بحث   │   ← بطاقات الإحصائيات  │
│  │1203  │ │4,852 │ │856   │ │45    │                       │
│  └──────┘ └──────┘ └──────┘ └──────┘                       │
├─────────────────────────────────────────────────────────────┤
│  ┌─────────────────────────────┐  ┌─────────────────────┐  │
│  │                             │  │                     │  │
│  │   مسار التحويل (Funnel)     │  │   النشاط اللحظي     │  │
│  │                             │  │                     │  │
│  │   - البحث والاكتشاف 100%    │  │   - رسالة واتساب    │  │
│  │   - عملاء مؤهلين 34%        │  │   - اكتمل بحث       │  │
│  │   - تم التواصل 15%          │  │   - إضافة عملاء     │  │
│  │   - فرص مبيعات 4%           │  │   - تقرير جديد      │  │
│  │   - صفقات مغلقة 1%          │  │                     │  │
│  │                             │  │                     │  │
│  ├─────────────────────────────┤  ├─────────────────────┤  │
│  │                             │  │                     │  │
│  │   معدل نشاط الفريق          │  │   حالة الاتصال      │  │
│  │   (رسم بياني أسبوعي)        │  │   متصل بـ Meta API  │  │
│  │                             │  │   +966 50 XXX XXXX  │  │
│  └─────────────────────────────┘  └─────────────────────┘  │
└─────────────────────────────────────────────────────────────┘
```

### المكونات الفرعية
| المكون | الوظيفة |
|--------|---------|
| `StatCard` | بطاقة إحصائية واحدة |
| `FunnelStep` | خطوة في مسار التحويل |
| `PerformanceChart` | رسم بياني للنشاط الأسبوعي |

### البيانات المعروضة
- إجمالي العملاء: `savedLeads.length + 1200`
- أدلة مكتشفة: `4,852` (ثابت)
- رسائل واتساب: `856` (ثابت)
- عمليات البحث: `jobs.length + 42`

---

## 4️⃣ البحث عن عملاء (Prospecting)

### المعلومات الأساسية
- **الملف:** `ProspectingPage.tsx`
- **المسار:** `/app/prospecting`
- **التخطيط:** داخل AppShell

### التصميم
```
┌─────────────────────────────────────────────────────────────┐
│  العنوان: البحث عن عملاء                   [قاعدة: 1.2M]   │
├─────────────────────────────────────────────────────────────┤
│  ┌─────────────────────────────────────────────────────┐   │
│  │  [🔍 النشاط...] [📍 المدينة] [بحث الآن]             │   │
│  └─────────────────────────────────────────────────────┘   │
├─────────────────────────────────────────────────────────────┤
│                                                             │
│  ┌─────────────────────────────┐  ┌─────────────────────┐  │
│  │                             │  │                     │  │
│  │   [فلاتر] [جدول|شبكة]       │  │   آخر عمليات البحث  │  │
│  │                             │  │                     │  │
│  │   ┌─────────────────────┐   │  │   - مطاعم الرياض   │  │
│  │   │ ☐ │ الشركة │ النشاط │   │  │   - مقاولات جدة    │  │
│  │   ├───┼────────┼────────┤   │  │                     │  │
│  │   │ ☐ │ شركة 1 │ برمجيات│   │  ├─────────────────────┤  │
│  │   │ ☐ │ شركة 2 │ أغذية  │   │  │                     │  │
│  │   │ ☐ │ شركة 3 │ صحة    │   │  │   اكتشاف بـ AI      │  │
│  │   └───┴────────┴────────┘   │  │   (بطاقة ترويجية)   │  │
│  │                             │  │                     │  │
│  └─────────────────────────────┘  └─────────────────────┘  │
│                                                             │
│  ┌─────────────────────────────────────────────────────┐   │
│  │  [X] تم اختيار 3 عملاء    [حفظ في قائمة]           │   │
│  └─────────────────────────────────────────────────────┘   │
└─────────────────────────────────────────────────────────────┘
```

### الحالات (States)
```typescript
const [keyword, setKeyword] = useState('');           // كلمة البحث
const [city, setCity] = useState('');                 // المدينة
const [isSearching, setIsSearching] = useState(false);// حالة البحث
const [selectedLeadIds, setSelectedLeadIds] = useState<string[]>([]); // المختارين
const [showSaveModal, setShowSaveModal] = useState(false); // مودال الحفظ
const [activeFilters, setActiveFilters] = useState<any>({}); // الفلاتر
const [viewMode, setViewMode] = useState<'TABLE' | 'GRID'>('TABLE'); // طريقة العرض
const [searchHistory, setSearchHistory] = useState([...]); // تاريخ البحث
```

### تدفق البحث
1. إدخال النشاط + المدينة
2. الضغط على "بحث الآن"
3. إنشاء Job من نوع SEARCH
4. عرض مؤشر التقدم
5. عرض النتائج (Mock Data: 6 شركات)
6. إضافة للتاريخ

### الفلاتر المتاحة
- `hasPhone`: يوجد رقم هاتف
- `hasWebsite`: يوجد موقع إلكتروني
- `status`: حالة العميل

### مودال اختيار القائمة
- خيار "بدون قائمة (CRM العام)"
- قائمة بالقوائم الموجودة
- حفظ جماعي للعملاء المختارين

---

## 5️⃣ إدارة العملاء (Leads Management)

### المعلومات الأساسية
- **الملف:** `LeadsManagementPage.tsx`
- **المسار:** `/app/leads`
- **التخطيط:** داخل AppShell

### التصميم
```
┌─────────────────────────────────────────────────────────────┐
│  العنوان: إدارة العملاء (CRM)      [استيراد CSV] [إضافة]   │
├─────────────────────────────────────────────────────────────┤
│  ┌─────────────────────────────────────────────────────┐   │
│  │  [🔍 البحث بالاسم، النشاط أو الموقع...]              │   │
│  └─────────────────────────────────────────────────────┘   │
│  [فلاتر ذكية: هاتف | موقع | الحالة]                        │
├─────────────────────────────────────────────────────────────┤
│  ┌─────────────────────────────────────────────────────┐   │
│  │ ☐ │ العميل        │ التحليل الرقمي │ الحالة │ ⋮   │   │
│  ├───┼────────────────┼────────────────┼────────┼─────┤   │
│  │ ☐ │ أرامكو        │ 5 أدلة | تقرير │ مؤهل   │ ⋮   │   │
│  │ ☐ │ بنك الراجحي   │ 2 أدلة | -     │ تواصل  │ ⋮   │   │
│  │ ☐ │ مطاعم الرومانسية│ 1 دليل | تقرير│ جديد   │ ⋮   │   │
│  └───┴────────────────┴────────────────┴────────┴─────┘   │
├─────────────────────────────────────────────────────────────┤
│  [X] تم اختيار 2 عملاء  [واتساب] [تصدير] [حذف]            │
└─────────────────────────────────────────────────────────────┘
```

### الأعمدة
| العمود | المحتوى |
|--------|---------|
| العميل | الاسم + النشاط + المدينة |
| التحليل الرقمي | عدد الأدلة + حالة التقرير |
| الحالة | شارة ملونة (جديد/تواصل/مؤهل) |
| الإجراءات | شركة، واتساب، حذف |

### الإجراءات الجماعية
- تصدير Excel (يُنشئ Job)
- Reveal Data (يُنشئ Job)
- واتساب جماعي
- حذف جماعي

---

## 6️⃣ إضافة عميل يدوي (New Lead)

### المعلومات الأساسية
- **الملف:** `NewLeadPage.tsx`
- **المسار:** `/app/leads/new`
- **التخطيط:** داخل AppShell

### الحقول
| الحقل | النوع | إلزامي |
|-------|-------|--------|
| اسم الشركة | text | ✓ |
| قطاع النشاط | text | - |
| المدينة | text | - (افتراضي: الرياض) |
| الموقع الإلكتروني | url | - |
| رقم الجوال | text | - |
| البريد الإلكتروني | email | - |

### السلوك
- عند الحفظ: إنشاء Lead جديد بـ ID يبدأ بـ `manual-`
- التوجيه لصفحة تفاصيل العميل الجديد

---

## 7️⃣ استيراد عملاء (Lead Import)

### المعلومات الأساسية
- **الملف:** `LeadImportPage.tsx`
- **المسار:** `/app/leads/import`
- **التخطيط:** داخل AppShell

### التصميم
```
┌─────────────────────────────────────────────────────────────┐
│  العنوان: استيراد عملاء (Bulk Import)                       │
├─────────────────────────────────────────────────────────────┤
│  ┌─────────────────────────────┐  ┌─────────────────────┐  │
│  │                             │  │                     │  │
│  │   منطقة رفع الملف           │  │   نموذج الملف       │  │
│  │   (Drag & Drop)             │  │   [تحميل النموذج]   │  │
│  │                             │  │                     │  │
│  │   CSV, XLSX, XLS            │  ├─────────────────────┤  │
│  │   حد أقصى 10MB              │  │                     │  │
│  │                             │  │   ملاحظات هامة      │  │
│  ├─────────────────────────────┤  │   - اسم الشركة إلزامي│  │
│  │                             │  │   - فحص التكرار     │  │
│  │   [✓] الملف جاهز            │  │   - كود الدولة      │  │
│  │   [بدء الاستيراد]           │  │                     │  │
│  │                             │  │                     │  │
│  └─────────────────────────────┘  └─────────────────────┘  │
└─────────────────────────────────────────────────────────────┘
```

### السلوك
1. رفع الملف (Drag & Drop أو Click)
2. عرض معلومات الملف
3. بدء الاستيراد (يُنشئ Job)
4. التوجيه لصفحة العملاء

---

## 8️⃣ تفاصيل العميل (Lead Detail)

### المعلومات الأساسية
- **الملف:** `LeadDetailPage.tsx`
- **المسار:** `/app/leads/:id`
- **التخطيط:** داخل AppShell

### التصميم
```
┌─────────────────────────────────────────────────────────────┐
│  [←] [أ] أرامكو السعودية [مؤهل ▼]                          │
│      طاقة • الظهران • صفحة الشركة                          │
│                                    [🗑] [واتساب] [فحص آلي]  │
├─────────────────────────────────────────────────────────────┤
│  ┌─────────────────┐  ┌─────────────────────────────────┐  │
│  │                 │  │                                 │  │
│  │ معلومات التواصل │  │  [نظرة عامة|أدلة|تقرير|سجل]     │  │
│  │                 │  │                                 │  │
│  │ 📞 05XXXXXXXX   │  │  ┌─────────────────────────┐   │  │
│  │ 🌐 aramco.com   │  │  │                         │   │  │
│  │                 │  │  │   محتوى التبويب         │   │  │
│  │ [تعديل البيانات]│  │  │                         │   │  │
│  │                 │  │  │                         │   │  │
│  ├─────────────────┤  │  │                         │   │  │
│  │                 │  │  │                         │   │  │
│  │ تحليل ليدززز    │  │  │                         │   │  │
│  │ 94/100         │  │  │                         │   │  │
│  │ تطابق النشاط 98%│  │  └─────────────────────────┘   │  │
│  │                 │  │                                 │  │
│  └─────────────────┘  └─────────────────────────────────┘  │
└─────────────────────────────────────────────────────────────┘
```

### التبويبات

#### نظرة عامة (Overview)
- رؤية المبيعات (Sales Insight)
- تفاصيل السياق (تاريخ الاكتشاف، المصدر، المستوى التقني)
- الفرص المقترحة

#### الأدلة (Evidence)
- قائمة الأدلة المكتشفة
- زر تشغيل الفحص إذا فارغة
- عرض تفاصيل الدليل في Drawer

#### التقرير الذكي (Report)
- ملخص التقرير
- أقسام التحليل مع مستويات الثقة
- الأدلة المرتبطة بكل قسم

#### السجل والنشاط (Activity)
- Timeline للإجراءات
- المستخدم المنفذ
- التوقيت

### الإجراءات
| الإجراء | الوظيفة |
|---------|---------|
| تغيير الحالة | Dropdown لتحديث status |
| فحص آلي | تشغيل Survey Job |
| تواصل واتساب | فتح WhatsAppModal |
| حذف | إزالة العميل |

---

## 9️⃣ تفاصيل الشركة (Company Detail)

### المعلومات الأساسية
- **الملف:** `CompanyDetailPage.tsx`
- **المسار:** `/app/companies/:id`
- **التخطيط:** داخل AppShell

### الأقسام
| القسم | المحتوى |
|-------|---------|
| Header | صورة غلاف + شعار + معلومات أساسية |
| رؤى الشركة | نبذة، مهمة، مركز السوق، أدلة رقمية |
| الموظفين | صناع القرار مع بيانات التواصل |
| النشاط الأخير | Timeline |
| بطاقة المعلومات | تأسيس، حجم، تقنيات |
| المنافسون | قائمة الشركات المنافسة |
| تقرير الذكاء التنافسي | تحليل AI |

### الإجراءات
- بدء خطة مبيعات (يُنشئ Job)
- العودة للخلف

---

## 🔟 القوائم (Lists)

### المعلومات الأساسية
- **الملف:** `ListsPage.tsx`
- **المسار:** `/app/lists`
- **التخطيط:** داخل AppShell

### التصميم
```
┌─────────────────────────────────────────────────────────────┐
│  العنوان: القوائم (Lists)              [إنشاء قائمة جديدة]  │
├─────────────────────────────────────────────────────────────┤
│  ┌──────────────┐ ┌──────────────┐ ┌──────────────┐        │
│  │ 📁           │ │ 📁           │ │ ➕           │        │
│  │              │ │              │ │              │        │
│  │ عملاء الرياض │ │ مطاعم جدة   │ │ إضافة قائمة  │        │
│  │ 42 عميل     │ │ 15 عميل     │ │   جديدة      │        │
│  │              │ │              │ │              │        │
│  │ [واتساب][📥] │ │ [واتساب][📥] │ │              │        │
│  └──────────────┘ └──────────────┘ └──────────────┘        │
└─────────────────────────────────────────────────────────────┘
```

### مودال إنشاء قائمة
- حقل اسم القائمة
- رسالة توضيحية
- أزرار إلغاء/حفظ

---

## 1️⃣1️⃣ تفاصيل القائمة (List Detail)

### المعلومات الأساسية
- **الملف:** `ListDetailPage.tsx`
- **المسار:** `/app/lists/:id`
- **التخطيط:** داخل AppShell

### العناصر
- Header مع اسم القائمة وعدد العملاء
- أزرار إرسال جماعي وتصدير
- حقل بحث داخل القائمة
- زر إضافة المزيد من البحث
- جدول العملاء مع إمكانية الإزالة

---

## 1️⃣2️⃣ إدارة واتساب (WhatsApp Management)

### المعلومات الأساسية
- **الملف:** `WhatsAppMessagesPage.tsx`
- **المسار:** `/app/whatsapp`
- **التخطيط:** داخل AppShell

### التبويبات

#### سجل الرسائل (LOG)
```
┌─────────────────────────────────────────────────────────────┐
│  [إجمالي: 0] [تم التسليم: 0] [فشل: 0]                       │
├─────────────────────────────────────────────────────────────┤
│  [🔍 بحث...] [الكل|ناجح|فاشل]                               │
├─────────────────────────────────────────────────────────────┤
│  │ العميل │ الرسالة │ الحالة │ التوقيت │                    │
│  ├────────┼─────────┼────────┼─────────┤                    │
│  │ ...    │ ...     │ ✓/✗    │ ...     │                    │
└─────────────────────────────────────────────────────────────┘
```

#### القوالب الجاهزة (TEMPLATES)
```
┌─────────────────────────────────────────────────────────────┐
│  مكتبة القوالب الذكية                    [قالب جديد]        │
├─────────────────────────────────────────────────────────────┤
│  ┌──────────────┐ ┌──────────────┐ ┌──────────────┐        │
│  │ 📋 تعريف عام │ │ 📋 قالب 2   │ │ 📋 قالب 3   │        │
│  │              │ │              │ │              │        │
│  │ "مرحباً..."  │ │ "..."       │ │ "..."       │        │
│  │              │ │              │ │              │        │
│  │ [تعديل]      │ │ [تعديل]      │ │ [تعديل]      │        │
│  └──────────────┘ └──────────────┘ └──────────────┘        │
└─────────────────────────────────────────────────────────────┘
```

### المتغيرات المدعومة
- `${name}` - اسم العميل
- `${industry}` - قطاع النشاط
- `${city}` - المدينة

### أقسام إضافية
- معايير الأمان المتقدمة (AES-256)
- الرقم المتصل حالياً (مع إمكانية التغيير)

---

## 1️⃣3️⃣ إدارة الفريق (Team Management)

### المعلومات الأساسية
- **الملف:** `TeamPage.tsx`
- **المسار:** `/app/team`
- **التخطيط:** داخل AppShell
- **الصلاحية:** ADMIN فقط

### الإحصائيات
- أعضاء الفريق
- إجمالي الصفقات
- رسائل واتساب
- معدل النشاط

### قائمة الأعضاء
| العمود | المحتوى |
|--------|---------|
| الصورة + الاسم | مع شارة الحالة (Online/Offline) |
| الدور | Admin / Sales |
| البريد | البريد الإلكتروني |
| تاريخ الانضمام | التاريخ |
| أداء المبيعات | عدد الصفقات + شريط تقدم |
| الإجراءات | صلاحيات، سجل، حذف |

### مودال دعوة عضو
- حقل البريد الإلكتروني
- اختيار الدور (Sales/Manager/Admin)
- رسالة توضيحية عن الدعوة

---

## 1️⃣4️⃣ التكاملات (Integrations)

### المعلومات الأساسية
- **الملف:** `IntegrationsPage.tsx`
- **المسار:** `/app/integrations`
- **التخطيط:** داخل AppShell
- **الصلاحية:** ADMIN فقط

### فئات التكاملات
| الفئة | التكاملات |
|-------|----------|
| التواصل الفعال | WhatsApp Business, Slack |
| إدارة علاقات العملاء | Salesforce, HubSpot |
| البيانات والأتمتة | Google Maps, Notion |

### حالات التكامل
- **متصل:** شارة خضراء + زر "إعدادات الربط"
- **غير متصل:** زر "بدء التوصيل"

### مودال إعدادات الربط
- معرف الربط
- آخر مزامنة
- إعدادات خاصة بكل تكامل
- أزرار: قطع الاتصال، مزامنة

### قسم API للمطورين
- طلب مفتاح API
- عرض التوثيق الفني

---

## 1️⃣5️⃣ سجل الرقابة (Audit Logs)

### المعلومات الأساسية
- **الملف:** `AuditLogsPage.tsx`
- **المسار:** `/app/audit-logs`
- **التخطيط:** داخل AppShell
- **الصلاحية:** ADMIN فقط

### التصميم
```
┌─────────────────────────────────────────────────────────────┐
│  العنوان: سجل الرقابة والامتثال           [تصدير CSV]       │
├─────────────────────────────────────────────────────────────┤
│  ┌─────────────────────────────┐  ┌─────────────────────┐  │
│  │                             │  │                     │  │
│  │ [🔍 بحث...] [تصفية التاريخ] │  │   سلامة النظام     │  │
│  │                             │  │   100% SECURE       │  │
│  │ العمليات الأخيرة            │  │   LZ-AES-256-GCM    │  │
│  │                             │  │                     │  │
│  │ │الإجراء│بواسطة│الهدف│وقت│  │  ├─────────────────────┤  │
│  │ ├──────┼──────┼─────┼───┤  │  │                     │  │
│  │ │تصدير │أحمد  │قائمة│...│  │  │   تحليل المخاطر     │  │
│  │ │حذف   │سارة  │شركة │...│  │  │   - دخول مريب: 0    │  │
│  │                             │  │   - حذف جماعي: 2    │  │
│  │                             │  │   - تصدير ضخم: 1    │  │
│  │                             │  │                     │  │
│  └─────────────────────────────┘  └─────────────────────┘  │
└─────────────────────────────────────────────────────────────┘
```

### ألوان الإجراءات
| الإجراء | اللون |
|---------|-------|
| حذف | أحمر |
| إرسال | أخضر |
| تصدير | أزرق |
| تعديل | برتقالي |
| أخرى | رمادي |

---

## 1️⃣6️⃣ الإعدادات (Settings)

### المعلومات الأساسية
- **الملف:** `SettingsPage.tsx`
- **المسار:** `/app/settings`
- **التخطيط:** داخل AppShell

### الأقسام
| القسم | المحتوى |
|-------|---------|
| الملف الشخصي | الصورة، الاسم، البريد |
| التنبيهات | تفضيلات الإشعارات (4 خيارات) |
| الأمان | 2FA، تغيير كلمة المرور |
| التكاملات و API | مفاتيح API، المزامنة السحابية |
| الاشتراك | تفاصيل الباقة (قريباً) |

### مودال إنشاء مفتاح API
- حقل اسم التطبيق
- رسالة تحذيرية عن الأمان
- توليد المفتاح

---

## 1️⃣7️⃣ إضافة المتصفح (Extension Side Panel)

### المعلومات الأساسية
- **الملف:** `ExtensionSidePanel.tsx`
- **المسار:** `/extension-preview`
- **التخطيط:** مستقل (بدون AppShell)
- **العرض:** 400px max

### التصميم
```
┌────────────────────────┐
│ ⚡ ليدززز EXTENSION    │
├────────────────────────┤
│ 🔗 LinkedIn Profile    │
│ أ/ عبد الله الحربي     │
├────────────────────────┤
│      [أ]               │
│  عبد الله الحربي       │
│  innotech.sa • تقنية   │
│                        │
│ [حفظ للـ CRM] [واتساب] │
├────────────────────────┤
│ [نظرة|تواصل|أدلة|سجل]  │
├────────────────────────┤
│                        │
│   محتوى التبويب        │
│                        │
├────────────────────────┤
│ [إعدادات] [لوحة التحكم]│
└────────────────────────┘
```

### التبويبات
| التبويب | المحتوى |
|---------|---------|
| نظرة عامة | رؤية AI، تفاصيل السياق، فحص عميق |
| تواصل | بيانات مخفية أو مكشوفة (Reveal) |
| أدلة | قائمة الأدلة المكتشفة |
| سجل | Timeline النشاط |

### حالة الكشف (Reveal)
- **IDLE:** زر "Reveal Data"
- **LOADING:** مؤشر تحميل
- **REVEALED:** عرض الهاتف والبريد

---

## 🆕 شاشات SaaS المخططة (Planned Screens)

> **حالة التنفيذ:** هذه الشاشات مخططة ولم تُنفذ بعد في الـ Frontend Prototype.
> يجب تنفيذها بدون كسر الشاشات الموجودة (17 شاشة).

---

### 18️⃣ شاشة التسجيل (Signup) - 📋 Planned

**المعلومات الأساسية:**
- **الملف:** `SignupPage.tsx`
- **المسار:** `/signup`
- **التخطيط:** شاشة كاملة بدون AppShell
- **الصلاحية:** عام (غير مسجل)
- **Permission Key:** N/A

**التصميم:**
```
┌─────────────────────────────────────────────────────────────┐
│                                                             │
│  ┌─────────────────────┐  ┌─────────────────────────────┐  │
│  │                     │  │                             │  │
│  │   الجانب المرئي     │  │      نموذج التسجيل         │  │
│  │                     │  │                             │  │
│  │   - شعار ليدززز     │  │   - الاسم الكامل           │  │
│  │   - العنوان         │  │   - البريد الإلكتروني      │  │
│  │   - المميزات        │  │   - كلمة المرور            │  │
│  │                     │  │   - اسم الشركة             │  │
│  │                     │  │   - رقم الهاتف (اختياري)   │  │
│  │                     │  │   - زر إنشاء الحساب        │  │
│  │                     │  │   - رابط تسجيل الدخول      │  │
│  └─────────────────────┘  └─────────────────────────────┘  │
│                                                             │
└─────────────────────────────────────────────────────────────┘
```

**العناصر:**
| العنصر | النوع | الوظيفة | API/Action |
|--------|-------|---------|------------|
| حقل الاسم | input[text] | اسم المستخدم | - |
| حقل البريد | input[email] | البريد الإلكتروني | - |
| حقل كلمة المرور | input[password] | كلمة المرور (مع مؤشر قوة) | - |
| حقل اسم الشركة | input[text] | اسم المنظمة | - |
| حقل الهاتف | input[tel] | رقم الهاتف (اختياري) | - |
| زر التسجيل | button[submit] | إنشاء الحساب | `POST /api/auth/signup` |
| رابط تسجيل الدخول | link | الانتقال لصفحة الدخول | Navigate to `/login` |

**الحالات (States):**
| الحالة | الوصف | UI |
|--------|-------|-----|
| Empty | النموذج فارغ | حقول فارغة، زر معطل |
| Filling | المستخدم يدخل البيانات | validation inline |
| Loading | جاري إنشاء الحساب | زر معطل + spinner |
| Error | خطأ في التسجيل | رسالة خطأ (بريد مستخدم، كلمة مرور ضعيفة) |
| Success | تم التسجيل | توجيه لـ `/onboarding` |

**API Contract:**
```
POST /api/auth/signup
Request: { name, email, password, organizationName, phone? }
Response: { user, tenant, token }
Errors: 400 (validation), 409 (email exists)
Audit: AUTH_SIGNUP
```

**DoD للتنفيذ:**
- [ ] إنشاء `SignupPage.tsx` بنفس تصميم `LoginPage.tsx`
- [ ] إضافة Route في Router
- [ ] ربط مع API
- [ ] اختبار جميع الحالات
- [ ] لا تغييرات في الشاشات الموجودة

---

### 19️⃣ شاشة التأهيل (Onboarding) - 📋 Planned

**المعلومات الأساسية:**
- **الملف:** `OnboardingPage.tsx`
- **المسار:** `/onboarding`
- **التخطيط:** شاشة كاملة مع Stepper
- **الصلاحية:** مسجل (بعد Signup مباشرة)
- **Permission Key:** N/A

**التصميم:**
```
┌─────────────────────────────────────────────────────────────┐
│                                                             │
│  ┌─────────────────────────────────────────────────────┐   │
│  │  [1. الملف الشخصي] → [2. الشركة] → [3. الفريق]     │   │
│  └─────────────────────────────────────────────────────┘   │
│                                                             │
│  ┌─────────────────────────────────────────────────────┐   │
│  │                                                     │   │
│  │              محتوى الخطوة الحالية                   │   │
│  │                                                     │   │
│  └─────────────────────────────────────────────────────┘   │
│                                                             │
│  ┌─────────────────────────────────────────────────────┐   │
│  │  [السابق]                              [التالي]    │   │
│  │                                        [تخطي]      │   │
│  └─────────────────────────────────────────────────────┘   │
│                                                             │
└─────────────────────────────────────────────────────────────┘
```

**الخطوات:**
| الخطوة | المحتوى | API |
|--------|---------|-----|
| 1. الملف الشخصي | صورة، رقم هاتف | `PATCH /api/users/me` |
| 2. الشركة | شعار، قطاع النشاط، الموقع | `PATCH /api/tenants/:id` |
| 3. الفريق | دعوة أعضاء (اختياري) | `POST /api/invites` |

**الحالات (States):**
| الحالة | الوصف | UI |
|--------|-------|-----|
| Step 1 | الملف الشخصي | نموذج + صورة |
| Step 2 | الشركة | نموذج + شعار |
| Step 3 | الفريق | قائمة دعوات |
| Skipped | تخطي خطوة | انتقال للخطوة التالية |
| Complete | اكتمال التأهيل | توجيه لـ `/app/dashboard` |

**DoD للتنفيذ:**
- [ ] إنشاء `OnboardingPage.tsx` مع Stepper
- [ ] إضافة Route في Router
- [ ] ربط مع APIs
- [ ] دعم التخطي لكل خطوة
- [ ] لا تغييرات في الشاشات الموجودة

---

### 20️⃣ شاشة تبديل المنظمة (Switch Tenant) - 📋 Planned

**المعلومات الأساسية:**
- **الملف:** `SwitchTenantPage.tsx` أو `TenantSwitcherModal.tsx`
- **المسار:** `/switch-tenant` أو Modal في Header
- **التخطيط:** Modal أو صفحة كاملة
- **الصلاحية:** مسجل
- **Permission Key:** N/A (كل مستخدم يرى منظماته فقط)

**التصميم:**
```
┌─────────────────────────────────────────────────────────────┐
│                    اختر المنظمة                             │
├─────────────────────────────────────────────────────────────┤
│                                                             │
│  ┌─────────────────────────────────────────────────────┐   │
│  │ [Logo] شركة التقنية                    ✓ الحالية   │   │
│  │        OWNER • 5 أعضاء                              │   │
│  └─────────────────────────────────────────────────────┘   │
│                                                             │
│  ┌─────────────────────────────────────────────────────┐   │
│  │ [Logo] شركة أخرى                                    │   │
│  │        SALES • 12 عضو                               │   │
│  └─────────────────────────────────────────────────────┘   │
│                                                             │
│  ┌─────────────────────────────────────────────────────┐   │
│  │ [+] إنشاء منظمة جديدة                               │   │
│  └─────────────────────────────────────────────────────┘   │
│                                                             │
└─────────────────────────────────────────────────────────────┘
```

**العناصر:**
| العنصر | النوع | الوظيفة | API/Action |
|--------|-------|---------|------------|
| قائمة المنظمات | list | عرض المنظمات المتاحة | `GET /api/tenants` |
| بطاقة منظمة | card | اختيار منظمة | `POST /api/auth/switch-tenant` |
| زر إنشاء منظمة | button | إنشاء منظمة جديدة | `POST /api/tenants` |

**الحالات (States):**
| الحالة | الوصف | UI |
|--------|-------|-----|
| Loading | تحميل المنظمات | Skeleton |
| Single | منظمة واحدة فقط | عرض مع تعطيل التبديل |
| Multiple | عدة منظمات | قائمة قابلة للاختيار |
| Switching | جاري التبديل | Loading overlay |
| Error | فشل التبديل | رسالة خطأ |

**API Contract:**
```
POST /api/auth/switch-tenant
Request: { tenantId }
Response: { tenant, token, refreshToken }
Errors: 403 (not a member)
Audit: AUTH_TENANT_SWITCH
```

**DoD للتنفيذ:**
- [ ] إنشاء `TenantSwitcherModal.tsx` أو صفحة
- [ ] إضافة في Header (AppShell)
- [ ] ربط مع API
- [ ] تحديث Token بعد التبديل
- [ ] لا تغييرات في الشاشات الموجودة

---

### 21️⃣ شاشة الاشتراك (Billing) - 📋 Planned

**المعلومات الأساسية:**
- **الملف:** `BillingPage.tsx`
- **المسار:** `/app/billing`
- **التخطيط:** داخل AppShell
- **الصلاحية:** OWNER فقط
- **Permission Key:** `billing:read`, `billing:manage`

**التصميم:**
```
┌─────────────────────────────────────────────────────────────┐
│  الاشتراك والفوترة                                         │
├─────────────────────────────────────────────────────────────┤
│                                                             │
│  ┌─────────────────────────────────────────────────────┐   │
│  │ الباقة الحالية: PRO                                 │   │
│  │ 299 ر.س/شهر • ينتهي في 1 فبراير 2026               │   │
│  │ [ترقية] [إلغاء]                                     │   │
│  └─────────────────────────────────────────────────────┘   │
│                                                             │
│  ┌─────────────────────────────────────────────────────┐   │
│  │ الاستخدام                                           │   │
│  │ ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ │   │
│  │ المستخدمين: 3/20                                    │   │
│  │ العملاء: 450/10,000                                 │   │
│  │ البحث: 45/1,000 (يتجدد في 1 فبراير)                │   │
│  └─────────────────────────────────────────────────────┘   │
│                                                             │
│  ┌─────────────────────────────────────────────────────┐   │
│  │ الفواتير                                            │   │
│  │ ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ │   │
│  │ يناير 2026 • 299 ر.س • مدفوعة [تحميل]              │   │
│  │ ديسمبر 2025 • 299 ر.س • مدفوعة [تحميل]             │   │
│  └─────────────────────────────────────────────────────┘   │
│                                                             │
└─────────────────────────────────────────────────────────────┘
```

**العناصر:**
| العنصر | النوع | الوظيفة | API/Action |
|--------|-------|---------|------------|
| بطاقة الباقة | card | عرض الباقة الحالية | `GET /api/billing/plan` |
| زر ترقية | button | فتح modal الترقية | `POST /api/billing/checkout` |
| زر إلغاء | button | إلغاء الاشتراك | `POST /api/billing/cancel` |
| بطاقات الاستخدام | cards | عرض الحدود | `GET /api/billing/usage` |
| جدول الفواتير | table | عرض الفواتير | `GET /api/billing/invoices` |
| زر تحميل | button | تحميل فاتورة PDF | `GET /api/billing/invoices/:id/pdf` |

**الحالات (States):**
| الحالة | الوصف | UI |
|--------|-------|-----|
| Loading | تحميل البيانات | Skeleton |
| Active | اشتراك نشط | عرض كامل |
| Trial | فترة تجريبية | تنبيه + عداد |
| Expired | اشتراك منتهي | تحذير + زر تجديد |
| Cancelled | ملغي | تاريخ الانتهاء + زر إعادة تفعيل |
| Error | خطأ في التحميل | رسالة خطأ + إعادة محاولة |

**API Contract:**
```
GET /api/billing/plan → { plan, status, expiresAt, cancelAtPeriodEnd }
GET /api/billing/usage → { quotas: [{ key, used, limit, resetsAt }] }
GET /api/billing/invoices → { invoices: [{ id, date, amount, status, pdfUrl }] }
POST /api/billing/checkout → { checkoutUrl } (Stripe redirect)
POST /api/billing/cancel → { cancelledAt }
Audit: SUBSCRIPTION_UPGRADED, SUBSCRIPTION_CANCELLED
```

**DoD للتنفيذ:**
- [ ] إنشاء `BillingPage.tsx`
- [ ] إضافة Route في Router
- [ ] إضافة في Sidebar (OWNER فقط)
- [ ] ربط مع Stripe Checkout
- [ ] لا تغييرات في الشاشات الموجودة

---

### 22️⃣ شاشة الحدود والاستخدام (Usage) - 📋 Planned

**المعلومات الأساسية:**
- **الملف:** `UsagePage.tsx`
- **المسار:** `/app/usage`
- **التخطيط:** داخل AppShell
- **الصلاحية:** ADMIN+
- **Permission Key:** `usage:read`

**التصميم:**
```
┌─────────────────────────────────────────────────────────────┐
│  الاستخدام والحدود                                          │
├─────────────────────────────────────────────────────────────┤
│                                                             │
│  ┌───────────────┐ ┌───────────────┐ ┌───────────────┐     │
│  │ العملاء       │ │ البحث/يوم    │ │ المستخدمين   │     │
│  │ ━━━━━━━━━━━━ │ │ ━━━━━━━━━━━━ │ │ ━━━━━━━━━━━━ │     │
│  │ 450/10,000   │ │ 45/1,000     │ │ 3/20         │     │
│  │ 4.5%         │ │ 4.5%         │ │ 15%          │     │
│  └───────────────┘ └───────────────┘ └───────────────┘     │
│                                                             │
│  ┌─────────────────────────────────────────────────────┐   │
│  │ الاستخدام عبر الوقت                                 │   │
│  │ [رسم بياني]                                         │   │
│  └─────────────────────────────────────────────────────┘   │
│                                                             │
│  ⚠️ تنبيه: اقتربت من حد البحث اليومي (90%)              │
│                                                             │
└─────────────────────────────────────────────────────────────┘
```

**العناصر:**
| العنصر | النوع | الوظيفة | API/Action |
|--------|-------|---------|------------|
| بطاقات الحدود | cards | عرض الاستخدام لكل حد | `GET /api/billing/usage` |
| رسم بياني | chart | الاستخدام عبر الوقت | `GET /api/billing/usage/history` |
| تنبيهات | alerts | تحذير عند الاقتراب من الحدود | - |
| زر ترقية | button | الانتقال لصفحة الاشتراك | Navigate to `/app/billing` |

**الحالات (States):**
| الحالة | الوصف | UI |
|--------|-------|-----|
| Loading | تحميل البيانات | Skeleton |
| Normal | استخدام طبيعي | بطاقات خضراء |
| Warning | اقتراب من الحد (80%+) | بطاقات صفراء + تنبيه |
| Critical | تجاوز الحد (95%+) | بطاقات حمراء + تحذير |
| Exceeded | تجاوز الحد | رسالة + زر ترقية |

**DoD للتنفيذ:**
- [ ] إنشاء `UsagePage.tsx`
- [ ] إضافة Route في Router
- [ ] إضافة في Sidebar (ADMIN+)
- [ ] ربط مع API
- [ ] لا تغييرات في الشاشات الموجودة

---

### 23️⃣ شاشة إعدادات الأمان (Security Settings) - 📋 Planned

**المعلومات الأساسية:**
- **الملف:** `SecuritySettingsPage.tsx`
- **المسار:** `/app/settings/security`
- **التخطيط:** داخل AppShell (تبويب في Settings)
- **الصلاحية:** مسجل (بعض الأقسام ADMIN+)
- **Permission Key:** متعدد حسب القسم

**التصميم:**
```
┌─────────────────────────────────────────────────────────────┐
│  إعدادات الأمان                                             │
├─────────────────────────────────────────────────────────────┤
│                                                             │
│  ┌─────────────────────────────────────────────────────┐   │
│  │ تغيير كلمة المرور                                   │   │
│  │ كلمة المرور الحالية: ••••••••                       │   │
│  │ كلمة المرور الجديدة: [________]                     │   │
│  │ تأكيد كلمة المرور: [________]                       │   │
│  │ [تحديث]                                             │   │
│  └─────────────────────────────────────────────────────┘   │
│                                                             │
│  ┌─────────────────────────────────────────────────────┐   │
│  │ الجلسات النشطة                                      │   │
│  │ ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ │   │
│  │ 🖥️ Chrome - Windows • الجلسة الحالية               │   │
│  │ 📱 Safari - iPhone • منذ 3 أيام [إنهاء]            │   │
│  │ [إنهاء جميع الجلسات الأخرى]                        │   │
│  └─────────────────────────────────────────────────────┘   │
│                                                             │
│  ┌─────────────────────────────────────────────────────┐   │
│  │ المصادقة الثنائية (2FA)                             │   │
│  │ الحالة: غير مفعل                                    │   │
│  │ [تفعيل] (قريباً)                                    │   │
│  └─────────────────────────────────────────────────────┘   │
│                                                             │
│  ┌─────────────────────────────────────────────────────┐   │
│  │ مفاتيح API (ADMIN+)                                 │   │
│  │ ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ │   │
│  │ leedz_pk_8a7b... • منذ 30 يوم [حذف]                │   │
│  │ [+ إنشاء مفتاح جديد]                               │   │
│  └─────────────────────────────────────────────────────┘   │
│                                                             │
└─────────────────────────────────────────────────────────────┘
```

**العناصر:**
| العنصر | النوع | الوظيفة | API/Action | Permission |
|--------|-------|---------|------------|------------|
| نموذج تغيير كلمة المرور | form | تحديث كلمة المرور | `POST /api/auth/change-password` | مسجل |
| قائمة الجلسات | list | عرض الجلسات النشطة | `GET /api/auth/sessions` | مسجل |
| زر إنهاء جلسة | button | إنهاء جلسة محددة | `DELETE /api/auth/sessions/:id` | مسجل |
| زر إنهاء الكل | button | إنهاء جميع الجلسات الأخرى | `DELETE /api/auth/sessions` | مسجل |
| تفعيل 2FA | button | تفعيل المصادقة الثنائية | `POST /api/auth/2fa/enable` | مسجل |
| قائمة مفاتيح API | list | عرض المفاتيح | `GET /api/api-keys` | ADMIN+ |
| زر إنشاء مفتاح | button | إنشاء مفتاح جديد | `POST /api/api-keys` | ADMIN+ |
| زر حذف مفتاح | button | حذف مفتاح | `DELETE /api/api-keys/:id` | ADMIN+ |

**الحالات (States):**
| الحالة | الوصف | UI |
|--------|-------|-----|
| Loading | تحميل البيانات | Skeleton |
| Normal | عرض عادي | جميع الأقسام |
| Updating | جاري التحديث | زر معطل + spinner |
| Success | تم التحديث | Toast نجاح |
| Error | خطأ | رسالة خطأ |

**DoD للتنفيذ:**
- [ ] إنشاء `SecuritySettingsPage.tsx`
- [ ] إضافة كتبويب في Settings
- [ ] ربط مع APIs
- [ ] إخفاء قسم API Keys لغير ADMIN
- [ ] لا تغييرات في الشاشات الموجودة

---

## 🧩 المكونات المشتركة

### AppShell
- القائمة الجانبية (Sidebar)
- Header مع بحث وإشعارات
- Command Palette (Ctrl+K)
- JobProgressWidget
- **Tenant Switcher (جديد)**

### WhatsAppModal
- اختيار قالب
- كتابة ذكية بـ AI
- إرسال الرسالة

### BulkActionsBar
- عداد العناصر المختارة
- أزرار الإجراءات الجماعية

### DataTable
- جدول مع اختيار متعدد
- أعمدة قابلة للتخصيص
- إجراءات لكل صف

### SmartFilters
- فلاتر سريعة (chips)
- تفعيل/إلغاء الفلاتر

### TenantSwitcher (جديد)
- عرض المنظمة الحالية
- قائمة المنظمات المتاحة
- زر تبديل سريع

---

> **الوثيقة التالية:** [04-USER-FLOWS.md](./04-USER-FLOWS.md) - تدفقات المستخدم
