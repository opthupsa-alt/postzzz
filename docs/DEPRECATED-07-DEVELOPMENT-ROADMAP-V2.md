# ğŸ—ºï¸ Ø®Ø§Ø±Ø·Ø© Ø·Ø±ÙŠÙ‚ Ø§Ù„ØªØ·ÙˆÙŠØ± - Analysis Pack v2 (Sprint-Based)

> **Ø§Ù„Ø¥ØµØ¯Ø§Ø±:** 2.0.0  
> **ØªØ§Ø±ÙŠØ® Ø§Ù„ØªØ­Ø¯ÙŠØ«:** ÙŠÙ†Ø§ÙŠØ± 2026  
> **Ø§Ù„Ø­Ø§Ù„Ø©:** Ø¬Ø§Ù‡Ø² Ù„Ù„ØªÙ†ÙÙŠØ°

---

## ğŸ“‹ Ù…Ù„Ø®Øµ Ø§Ù„ØªØºÙŠÙŠØ±Ø§Øª Ù…Ù† v1

| Ø§Ù„ØªØºÙŠÙŠØ± | Ø§Ù„ÙˆØµÙ |
|---------|-------|
| âœ… Sprint-based | ØªØ­ÙˆÙŠÙ„ Ù…Ù† Ù…Ø±Ø§Ø­Ù„ Ø¹Ø§Ù…Ø© Ø¥Ù„Ù‰ Sprints Ù…Ø­Ø¯Ø¯Ø© |
| âœ… Frontend-first | Ø§Ù„Ø®Ø·Ø© ØªØ¨Ø¯Ø£ Ù…Ù† Backend Ù…Ø¹ Ø±Ø¨Ø· ØªØ¯Ø±ÙŠØ¬ÙŠ Ù„Ù„Ù€ Frontend Ø§Ù„Ù…ÙˆØ¬ÙˆØ¯ |
| âœ… SaaS Priority | Sprint 0 Ù…Ø®ØµØµ Ù„Ù„Ù€ Multi-tenancy |
| âœ… API Contracts | ÙƒÙ„ Sprint ÙŠÙÙ†ØªØ¬ APIs Ù‚Ø§Ø¨Ù„Ø© Ù„Ù„Ø±Ø¨Ø· ÙÙˆØ±Ø§Ù‹ |
| âœ… Extension Sprint | Sprint Ù…Ø®ØµØµ Ù„Ù„Ù€ Browser Extension |

---

## ğŸ¯ Ø§Ù„Ø­Ø§Ù„Ø© Ø§Ù„Ø­Ø§Ù„ÙŠØ©

### Ù…Ø§ ØªÙ… Ø¥Ù†Ø¬Ø§Ø²Ù‡ âœ… (Frontend Prototype)
- [x] 17 Ø´Ø§Ø´Ø© ÙƒØ§Ù…Ù„Ø© (React + TypeScript)
- [x] Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø­Ø§Ù„Ø© (Zustand Store)
- [x] Ø§Ù„ØªÙ†Ù‚Ù„ ÙˆØ§Ù„ØªÙˆØ¬ÙŠÙ‡ (React Router)
- [x] ØªØµÙ…ÙŠÙ… RTL Ø¹Ø±Ø¨ÙŠ Ø£ÙˆÙ„Ø§Ù‹
- [x] Mock Data Ù„Ù„ØªØ¬Ø±Ø¨Ø©
- [x] 15 Ù…ÙƒÙˆÙ† Ù‚Ø§Ø¨Ù„ Ù„Ø¥Ø¹Ø§Ø¯Ø© Ø§Ù„Ø§Ø³ØªØ®Ø¯Ø§Ù…
- [x] ØªÙˆØ«ÙŠÙ‚ Ø´Ø§Ù…Ù„ (Analysis Pack v1)

### Ù…Ø§ ÙŠØ­ØªØ§Ø¬ ØªØ·ÙˆÙŠØ± ğŸ”§ (Backend + Integration)
- [ ] Backend API (Node.js/NestJS)
- [ ] Ù‚Ø§Ø¹Ø¯Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª (PostgreSQL)
- [ ] Multi-tenancy
- [ ] Ø§Ù„Ù…ØµØ§Ø¯Ù‚Ø© Ø§Ù„Ø­Ù‚ÙŠÙ‚ÙŠØ© (JWT)
- [ ] RBAC (4 Ø£Ø¯ÙˆØ§Ø±)
- [ ] Ù†Ø¸Ø§Ù… Ø§Ù„Ù…Ù‡Ø§Ù… (Jobs + Queue)
- [ ] ØªÙƒØ§Ù…Ù„ Google Maps API
- [ ] ØªÙƒØ§Ù…Ù„ WhatsApp Business API
- [ ] ØªØ­Ù„ÙŠÙ„ AI Ù„Ù„ØªÙ‚Ø§Ø±ÙŠØ±
- [ ] Browser Extension
- [ ] Ù†Ø¸Ø§Ù… Ø§Ù„Ø§Ø´ØªØ±Ø§ÙƒØ§Øª

---

## ğŸ“… Ø®Ø·Ø© Sprints

### Ù†Ø¸Ø±Ø© Ø¹Ø§Ù…Ø©

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                                                                          â”‚
â”‚  Sprint 0: Foundation + SaaS        â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘  â”‚
â”‚  (3 Ø£Ø³Ø§Ø¨ÙŠØ¹)                         Week 1-3                            â”‚
â”‚                                                                          â”‚
â”‚  Sprint 1: Core CRUD + Auth         â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘  â”‚
â”‚  (3 Ø£Ø³Ø§Ø¨ÙŠØ¹)                         Week 4-6                            â”‚
â”‚                                                                          â”‚
â”‚  Sprint 2: Jobs + Survey            â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘  â”‚
â”‚  (3 Ø£Ø³Ø§Ø¨ÙŠØ¹)                         Week 7-9                            â”‚
â”‚                                                                          â”‚
â”‚  Sprint 3: WhatsApp + Integrations  â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘  â”‚
â”‚  (3 Ø£Ø³Ø§Ø¨ÙŠØ¹)                         Week 10-12                          â”‚
â”‚                                                                          â”‚
â”‚  Sprint 4: AI + Reports             â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–ˆâ–ˆâ–ˆâ–ˆ  â”‚
â”‚  (2 Ø£Ø³Ø§Ø¨ÙŠØ¹)                         Week 13-14                          â”‚
â”‚                                                                          â”‚
â”‚  Sprint 5: Extension + Polish       â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–ˆâ–ˆ  â”‚
â”‚  (2 Ø£Ø³Ø§Ø¨ÙŠØ¹)                         Week 15-16                          â”‚
â”‚                                                                          â”‚
â”‚  Sprint 6: Billing + Launch         â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–ˆ  â”‚
â”‚  (2 Ø£Ø³Ø§Ø¨ÙŠØ¹)                         Week 17-18                          â”‚
â”‚                                                                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠ: 18 Ø£Ø³Ø¨ÙˆØ¹ (4.5 Ø£Ø´Ù‡Ø±)
```

---

## ğŸ—ï¸ Sprint 0: Foundation + SaaS (Week 1-3)

### Ø§Ù„Ù‡Ø¯Ù
Ø¥Ø¹Ø¯Ø§Ø¯ Ø§Ù„Ø¨Ù†ÙŠØ© Ø§Ù„ØªØ­ØªÙŠØ© Ø§Ù„Ø£Ø³Ø§Ø³ÙŠØ© Ù…Ø¹ Multi-tenancy Ù…Ù† Ø§Ù„ÙŠÙˆÙ… Ø§Ù„Ø£ÙˆÙ„.

### Ø§Ù„Ù…Ù‡Ø§Ù…

#### Week 1: Project Setup
```
Backend:
â”œâ”€â”€ Ø¥Ù†Ø´Ø§Ø¡ Ù…Ø´Ø±ÙˆØ¹ NestJS
â”œâ”€â”€ Ø¥Ø¹Ø¯Ø§Ø¯ TypeScript + ESLint + Prettier
â”œâ”€â”€ Ø¥Ø¹Ø¯Ø§Ø¯ Docker + docker-compose
â”œâ”€â”€ Ø¥Ø¹Ø¯Ø§Ø¯ PostgreSQL + Prisma
â”œâ”€â”€ Ø¥Ù†Ø´Ø§Ø¡ Database Schema (Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø¬Ø¯Ø§ÙˆÙ„)
â”œâ”€â”€ Ø¥Ø¹Ø¯Ø§Ø¯ Migrations
â””â”€â”€ Seed data Ù„Ù„ØªØ·ÙˆÙŠØ±

DevOps:
â”œâ”€â”€ Ø¥Ø¹Ø¯Ø§Ø¯ GitHub repository
â”œâ”€â”€ Ø¥Ø¹Ø¯Ø§Ø¯ GitHub Actions (CI)
â”œâ”€â”€ Ø¥Ø¹Ø¯Ø§Ø¯ Ø¨ÙŠØ¦Ø© Development
â””â”€â”€ Ø¥Ø¹Ø¯Ø§Ø¯ Secrets management
```

#### Week 2: Multi-tenancy Core
```
Entities:
â”œâ”€â”€ tenants table + CRUD
â”œâ”€â”€ users table + CRUD
â”œâ”€â”€ memberships table + CRUD
â”œâ”€â”€ invites table + CRUD
â””â”€â”€ RLS policies

Middleware:
â”œâ”€â”€ Tenant context middleware
â”œâ”€â”€ Tenant scoping ÙÙŠ repositories
â””â”€â”€ JWT structure Ù…Ø¹ tenant context
```

#### Week 3: Auth Foundation
```
Auth:
â”œâ”€â”€ POST /api/auth/signup (create tenant + owner)
â”œâ”€â”€ POST /api/auth/login
â”œâ”€â”€ POST /api/auth/logout
â”œâ”€â”€ POST /api/auth/refresh
â”œâ”€â”€ GET /api/auth/me
â”œâ”€â”€ POST /api/auth/switch-tenant
â””â”€â”€ Email verification (basic)

Security:
â”œâ”€â”€ Password hashing (Argon2)
â”œâ”€â”€ JWT signing/verification
â”œâ”€â”€ Rate limiting
â”œâ”€â”€ CORS configuration
â””â”€â”€ Security headers (Helmet)
```

### Ø§Ù„Ù…Ø®Ø±Ø¬Ø§Øª
- âœ… Backend project structure
- âœ… Database with all tables
- âœ… Multi-tenancy working
- âœ… Auth endpoints working
- âœ… CI pipeline

### Frontend Integration
```typescript
// Ø¥Ø¶Ø§ÙØ© API client
// src/api/client.ts
const api = axios.create({
  baseURL: import.meta.env.VITE_API_URL,
  withCredentials: true
});

api.interceptors.request.use((config) => {
  const token = localStorage.getItem('accessToken');
  if (token) {
    config.headers.Authorization = `Bearer ${token}`;
  }
  return config;
});

// ØªØ­Ø¯ÙŠØ« LoginPage Ù„Ù„Ø§ØªØµØ§Ù„ Ø¨Ù€ API
// ØªØ­Ø¯ÙŠØ« App.tsx Ù„Ù„ØªØ­Ù‚Ù‚ Ù…Ù† auth state
```

---

## ğŸ” Sprint 1: Core CRUD + RBAC (Week 4-6)

### Ø§Ù„Ù‡Ø¯Ù
ØªÙ†ÙÙŠØ° CRUD Ø§Ù„Ø£Ø³Ø§Ø³ÙŠ Ù„Ù„Ù€ Leads Ù…Ø¹ Ù†Ø¸Ø§Ù… Ø§Ù„ØµÙ„Ø§Ø­ÙŠØ§Øª.

### Ø§Ù„Ù…Ù‡Ø§Ù…

#### Week 4: Leads CRUD
```
Endpoints:
â”œâ”€â”€ GET /api/leads (with pagination, filters, search)
â”œâ”€â”€ GET /api/leads/:id
â”œâ”€â”€ POST /api/leads
â”œâ”€â”€ POST /api/leads/bulk
â”œâ”€â”€ PATCH /api/leads/:id
â”œâ”€â”€ PATCH /api/leads/:id/status
â”œâ”€â”€ DELETE /api/leads/:id
â””â”€â”€ DELETE /api/leads/bulk

Features:
â”œâ”€â”€ Full-text search (Arabic)
â”œâ”€â”€ Filtering (status, hasPhone, hasWebsite, etc.)
â”œâ”€â”€ Sorting
â”œâ”€â”€ Pagination
â””â”€â”€ Tenant scoping
```

#### Week 5: Lists + Team
```
Lists:
â”œâ”€â”€ GET /api/lists
â”œâ”€â”€ GET /api/lists/:id
â”œâ”€â”€ POST /api/lists
â”œâ”€â”€ PATCH /api/lists/:id
â”œâ”€â”€ DELETE /api/lists/:id
â”œâ”€â”€ POST /api/lists/:id/leads
â””â”€â”€ DELETE /api/lists/:id/leads

Team:
â”œâ”€â”€ GET /api/team
â”œâ”€â”€ POST /api/team/invite
â”œâ”€â”€ POST /api/team/invite/:token/accept
â”œâ”€â”€ PATCH /api/team/:id/role
â”œâ”€â”€ DELETE /api/team/:id
â””â”€â”€ GET /api/team/invites
```

#### Week 6: RBAC + Audit
```
RBAC:
â”œâ”€â”€ Permission middleware
â”œâ”€â”€ Role-based access control
â”œâ”€â”€ Owner/Admin/Manager/Sales logic
â””â”€â”€ Scope filtering (own/team/all)

Audit:
â”œâ”€â”€ Audit log middleware
â”œâ”€â”€ POST /api/audit-logs (internal)
â”œâ”€â”€ GET /api/audit-logs (admin only)
â””â”€â”€ Audit event types
```

### Ø§Ù„Ù…Ø®Ø±Ø¬Ø§Øª
- âœ… Leads CRUD working
- âœ… Lists CRUD working
- âœ… Team management working
- âœ… RBAC enforced
- âœ… Audit logging

### Frontend Integration
```typescript
// ØªØ­Ø¯ÙŠØ« useStore Ù„Ø§Ø³ØªØ®Ø¯Ø§Ù… API
// src/store/useStore.ts

// Before (Mock):
// saveLead: (lead) => set((state) => ({ savedLeads: [...state.savedLeads, lead] }))

// After (API):
saveLead: async (lead) => {
  const response = await api.post('/leads', lead);
  set((state) => ({ savedLeads: [...state.savedLeads, response.data] }));
}

// ØªØ­Ø¯ÙŠØ« Guard component Ù„Ù„ØªØ­Ù‚Ù‚ Ù…Ù† permissions
// ØªØ­Ø¯ÙŠØ« TeamPage Ù„Ù„Ø§ØªØµØ§Ù„ Ø¨Ù€ API
// ØªØ­Ø¯ÙŠØ« AuditLogsPage Ù„Ù„Ø§ØªØµØ§Ù„ Ø¨Ù€ API
```

---

## âš™ï¸ Sprint 2: Jobs + Survey (Week 7-9)

### Ø§Ù„Ù‡Ø¯Ù
ØªÙ†ÙÙŠØ° Ù†Ø¸Ø§Ù… Ø§Ù„Ù…Ù‡Ø§Ù… Ø§Ù„Ø®Ù„ÙÙŠØ© ÙˆØ§Ù„ÙØ­Øµ Ø§Ù„Ø¢Ù„ÙŠ.

### Ø§Ù„Ù…Ù‡Ø§Ù…

#### Week 7: Job Infrastructure
```
Infrastructure:
â”œâ”€â”€ Ø¥Ø¹Ø¯Ø§Ø¯ Redis
â”œâ”€â”€ Ø¥Ø¹Ø¯Ø§Ø¯ BullMQ
â”œâ”€â”€ Job queue configuration
â”œâ”€â”€ Job workers
â””â”€â”€ WebSocket setup (Socket.io)

Endpoints:
â”œâ”€â”€ GET /api/jobs
â”œâ”€â”€ GET /api/jobs/:id
â”œâ”€â”€ GET /api/jobs/:id/logs
â”œâ”€â”€ POST /api/jobs/:id/cancel
â””â”€â”€ WebSocket: job progress updates
```

#### Week 8: Search Job
```
Search:
â”œâ”€â”€ POST /api/search
â”œâ”€â”€ GET /api/search/:jobId/results
â”œâ”€â”€ Google Maps Places API integration
â”œâ”€â”€ Result caching
â””â”€â”€ Rate limiting

Job Flow:
â”œâ”€â”€ Create SEARCH job
â”œâ”€â”€ Call Google Maps API
â”œâ”€â”€ Parse results
â”œâ”€â”€ Update progress via WebSocket
â””â”€â”€ Return results
```

#### Week 9: Survey Job
```
Survey:
â”œâ”€â”€ POST /api/leads/:id/survey
â”œâ”€â”€ GET /api/leads/:id/evidence
â”œâ”€â”€ GET /api/leads/:id/report
â”œâ”€â”€ Web scraping service
â””â”€â”€ Evidence extraction

Job Flow:
â”œâ”€â”€ Create SURVEY job
â”œâ”€â”€ Fetch website content
â”œâ”€â”€ Extract evidence
â”œâ”€â”€ Store evidence
â”œâ”€â”€ Update lead status to PROSPECTED
â””â”€â”€ Notify via WebSocket
```

### Ø§Ù„Ù…Ø®Ø±Ø¬Ø§Øª
- âœ… Job queue working
- âœ… WebSocket updates working
- âœ… Search job working (Google Maps)
- âœ… Survey job working (basic)
- âœ… Evidence storage

### Frontend Integration
```typescript
// ØªØ­Ø¯ÙŠØ« JobProgressWidget Ù„Ù„Ø§ØªØµØ§Ù„ Ø¨Ù€ WebSocket
// src/components/JobProgressWidget.tsx

useEffect(() => {
  const socket = io(import.meta.env.VITE_WS_URL);
  
  socket.on('job:progress', (data) => {
    updateJob(data.id, { progress: data.progress, message: data.message });
  });
  
  socket.on('job:completed', (data) => {
    updateJob(data.id, { status: 'SUCCESS', result: data.result });
    showToast('SUCCESS', 'Ø§ÙƒØªÙ…Ù„', data.message);
  });
  
  return () => socket.disconnect();
}, []);

// ØªØ­Ø¯ÙŠØ« ProspectingPage Ù„Ø§Ø³ØªØ®Ø¯Ø§Ù… API
// ØªØ­Ø¯ÙŠØ« LeadDetailPage Ù„ØªØ´ØºÙŠÙ„ Survey
```

---

## ğŸ’¬ Sprint 3: WhatsApp + Integrations (Week 10-12)

### Ø§Ù„Ù‡Ø¯Ù
ØªÙ†ÙÙŠØ° ØªÙƒØ§Ù…Ù„ WhatsApp Business API ÙˆØ§Ù„ØªÙƒØ§Ù…Ù„Ø§Øª Ø§Ù„Ø£Ø®Ø±Ù‰.

### Ø§Ù„Ù…Ù‡Ø§Ù…

#### Week 10: WhatsApp Core
```
Setup:
â”œâ”€â”€ Meta Business Account setup
â”œâ”€â”€ WhatsApp Business API configuration
â”œâ”€â”€ Phone number registration
â””â”€â”€ Webhook endpoint

Endpoints:
â”œâ”€â”€ POST /api/whatsapp/send
â”œâ”€â”€ POST /api/whatsapp/send/bulk
â”œâ”€â”€ GET /api/whatsapp/messages
â”œâ”€â”€ GET /api/whatsapp/status
â””â”€â”€ POST /api/whatsapp/webhook (Meta callback)
```

#### Week 11: Templates + Messages
```
Templates:
â”œâ”€â”€ GET /api/whatsapp/templates
â”œâ”€â”€ POST /api/whatsapp/templates
â”œâ”€â”€ PATCH /api/whatsapp/templates/:id
â”œâ”€â”€ DELETE /api/whatsapp/templates/:id
â””â”€â”€ Template variable substitution

Messages:
â”œâ”€â”€ WHATSAPP job type
â”œâ”€â”€ WHATSAPP_BULK job type
â”œâ”€â”€ Delivery status tracking
â”œâ”€â”€ Idempotency handling
â””â”€â”€ Activity logging
```

#### Week 12: Integrations Framework
```
Framework:
â”œâ”€â”€ Integration connections table
â”œâ”€â”€ Credentials encryption
â”œâ”€â”€ Connection status tracking
â””â”€â”€ Sync job infrastructure

Endpoints:
â”œâ”€â”€ GET /api/integrations
â”œâ”€â”€ POST /api/integrations/:type/connect
â”œâ”€â”€ POST /api/integrations/:type/disconnect
â”œâ”€â”€ POST /api/integrations/:type/sync
â””â”€â”€ GET /api/integrations/:type/status

API Keys:
â”œâ”€â”€ GET /api/api-keys
â”œâ”€â”€ POST /api/api-keys
â”œâ”€â”€ DELETE /api/api-keys/:id
â””â”€â”€ API key authentication middleware
```

### Ø§Ù„Ù…Ø®Ø±Ø¬Ø§Øª
- âœ… WhatsApp sending working
- âœ… Templates management working
- âœ… Message logging working
- âœ… Integrations framework ready
- âœ… API keys management

### Frontend Integration
```typescript
// ØªØ­Ø¯ÙŠØ« WhatsAppModal Ù„Ù„Ø§ØªØµØ§Ù„ Ø¨Ù€ API
// ØªØ­Ø¯ÙŠØ« WhatsAppMessagesPage Ù„Ù„Ø§ØªØµØ§Ù„ Ø¨Ù€ API
// ØªØ­Ø¯ÙŠØ« IntegrationsPage Ù„Ù„Ø§ØªØµØ§Ù„ Ø¨Ù€ API
// ØªØ­Ø¯ÙŠØ« SettingsPage (API Keys section)
```

---

## ğŸ¤– Sprint 4: AI + Reports (Week 13-14)

### Ø§Ù„Ù‡Ø¯Ù
ØªÙ†ÙÙŠØ° Ø§Ù„ØªØ­Ù„ÙŠÙ„ Ø§Ù„Ø°ÙƒÙŠ ÙˆØªÙˆÙ„ÙŠØ¯ Ø§Ù„ØªÙ‚Ø§Ø±ÙŠØ±.

### Ø§Ù„Ù…Ù‡Ø§Ù…

#### Week 13: AI Integration
```
Setup:
â”œâ”€â”€ OpenAI/Gemini API integration
â”œâ”€â”€ Prompt templates
â”œâ”€â”€ Response parsing
â””â”€â”€ Error handling

Features:
â”œâ”€â”€ Report generation from evidence
â”œâ”€â”€ Lead scoring
â”œâ”€â”€ Confidence levels
â””â”€â”€ Evidence linking
```

#### Week 14: Smart Features
```
AI Writing:
â”œâ”€â”€ POST /api/ai/generate-message
â”œâ”€â”€ Message personalization
â””â”€â”€ Tone adjustment

Report:
â”œâ”€â”€ REPORT job type
â”œâ”€â”€ Section generation
â”œâ”€â”€ Summary generation
â””â”€â”€ Score calculation

Enhancements:
â”œâ”€â”€ AI suggestions in search
â”œâ”€â”€ Smart list recommendations
â””â”€â”€ Activity insights
```

### Ø§Ù„Ù…Ø®Ø±Ø¬Ø§Øª
- âœ… AI report generation working
- âœ… Lead scoring working
- âœ… AI message writing working
- âœ… Smart suggestions

### Frontend Integration
```typescript
// ØªØ­Ø¯ÙŠØ« ReportViewer Ù„Ø¹Ø±Ø¶ Ø§Ù„ØªÙ‚Ø§Ø±ÙŠØ± Ø§Ù„Ø­Ù‚ÙŠÙ‚ÙŠØ©
// ØªØ­Ø¯ÙŠØ« WhatsAppModal Ù„Ø§Ø³ØªØ®Ø¯Ø§Ù… AI writing
// ØªØ­Ø¯ÙŠØ« LeadDetailPage Ù„Ø¹Ø±Ø¶ score
```

---

## ğŸ”Œ Sprint 5: Extension + Polish (Week 15-16)

### Ø§Ù„Ù‡Ø¯Ù
ØªÙ†ÙÙŠØ° Browser Extension ÙˆØªØ­Ø³ÙŠÙ† Ø§Ù„ØªØ¬Ø±Ø¨Ø©.

### Ø§Ù„Ù…Ù‡Ø§Ù…

#### Week 15: Extension Backend
```
CORS:
â”œâ”€â”€ chrome-extension:// origin allowed
â”œâ”€â”€ Extension-specific auth flow
â””â”€â”€ Tenant context in extension

Endpoints:
â”œâ”€â”€ POST /api/extension/resolve (detect entity)
â”œâ”€â”€ POST /api/extension/reveal (reveal data)
â”œâ”€â”€ POST /api/extension/save (save to CRM)
â””â”€â”€ GET /api/extension/context (current tenant)

Features:
â”œâ”€â”€ LinkedIn profile detection
â”œâ”€â”€ Company website detection
â”œâ”€â”€ Data extraction
â””â”€â”€ CRM save
```

#### Week 16: Extension Frontend + Polish
```
Extension:
â”œâ”€â”€ Chrome Extension manifest v3
â”œâ”€â”€ Content script
â”œâ”€â”€ Side panel UI (from ExtensionSidePanel.tsx)
â”œâ”€â”€ Auth flow (use web session)
â””â”€â”€ Chrome Web Store preparation

Polish:
â”œâ”€â”€ Error states in all screens
â”œâ”€â”€ Loading states
â”œâ”€â”€ Empty states
â”œâ”€â”€ Toast improvements
â””â”€â”€ Performance optimization
```

### Ø§Ù„Ù…Ø®Ø±Ø¬Ø§Øª
- âœ… Extension working
- âœ… All error states implemented
- âœ… Performance optimized
- âœ… Ready for Chrome Web Store

### Frontend Integration
```typescript
// Ø¥Ù†Ø´Ø§Ø¡ Extension project Ù…Ù†ÙØµÙ„
// Ø§Ø³ØªØ®Ø¯Ø§Ù… ExtensionSidePanel.tsx ÙƒØ£Ø³Ø§Ø³
// Ø±Ø¨Ø· Ø¨Ù€ API endpoints
```

---

## ğŸ’³ Sprint 6: Billing + Launch (Week 17-18)

### Ø§Ù„Ù‡Ø¯Ù
ØªÙ†ÙÙŠØ° Ù†Ø¸Ø§Ù… Ø§Ù„Ø§Ø´ØªØ±Ø§ÙƒØ§Øª ÙˆØ§Ù„Ø¥Ø·Ù„Ø§Ù‚.

### Ø§Ù„Ù…Ù‡Ø§Ù…

#### Week 17: Billing
```
Stripe Integration:
â”œâ”€â”€ Stripe account setup
â”œâ”€â”€ Products/Prices creation
â”œâ”€â”€ Checkout session
â”œâ”€â”€ Webhook handling
â””â”€â”€ Subscription management

Endpoints:
â”œâ”€â”€ GET /api/billing/plans
â”œâ”€â”€ GET /api/billing/subscription
â”œâ”€â”€ POST /api/billing/checkout
â”œâ”€â”€ POST /api/billing/portal
â”œâ”€â”€ POST /api/billing/webhook
â””â”€â”€ GET /api/billing/usage

Usage Limits:
â”œâ”€â”€ Usage counter middleware
â”œâ”€â”€ Limit enforcement
â”œâ”€â”€ Upgrade prompts
â””â”€â”€ Feature flags by plan
```

#### Week 18: Launch Preparation
```
Testing:
â”œâ”€â”€ E2E tests (Playwright)
â”œâ”€â”€ Load testing
â”œâ”€â”€ Security audit
â””â”€â”€ Bug fixes

Deployment:
â”œâ”€â”€ Production environment
â”œâ”€â”€ Database migration
â”œâ”€â”€ Monitoring (Sentry)
â”œâ”€â”€ Analytics (Mixpanel)
â””â”€â”€ Backup strategy

Documentation:
â”œâ”€â”€ API documentation (Swagger)
â”œâ”€â”€ User guide
â””â”€â”€ Admin guide
```

### Ø§Ù„Ù…Ø®Ø±Ø¬Ø§Øª
- âœ… Billing working
- âœ… Usage limits enforced
- âœ… Production deployed
- âœ… Monitoring active
- âœ… Documentation complete

### Frontend Integration
```typescript
// Ø¥Ø¶Ø§ÙØ© Ø´Ø§Ø´Ø© /app/billing
// Ø¥Ø¶Ø§ÙØ© Upgrade prompts
// Ø¥Ø¶Ø§ÙØ© Usage indicators
```

---

## ğŸ“Š API Mapping Table (Sprint-by-Sprint)

### Sprint 0 APIs
| Endpoint | Method | Permission | Job? | Audit? |
|----------|--------|------------|------|--------|
| /api/auth/signup | POST | Public | âœ— | âœ“ |
| /api/auth/login | POST | Public | âœ— | âœ“ |
| /api/auth/logout | POST | Auth | âœ— | âœ“ |
| /api/auth/refresh | POST | Auth | âœ— | âœ— |
| /api/auth/me | GET | Auth | âœ— | âœ— |
| /api/auth/switch-tenant | POST | Auth | âœ— | âœ“ |

### Sprint 1 APIs
| Endpoint | Method | Permission | Job? | Audit? |
|----------|--------|------------|------|--------|
| /api/leads | GET | leads:read | âœ— | âœ— |
| /api/leads | POST | leads:create | âœ— | âœ“ |
| /api/leads/:id | GET | leads:read | âœ— | âœ— |
| /api/leads/:id | PATCH | leads:update | âœ— | âœ“ |
| /api/leads/:id | DELETE | leads:delete | âœ— | âœ“ |
| /api/leads/bulk | POST | leads:create | âœ— | âœ“ |
| /api/leads/bulk | DELETE | leads:delete | âœ— | âœ“ |
| /api/lists | GET | lists:read | âœ— | âœ— |
| /api/lists | POST | lists:create | âœ— | âœ“ |
| /api/lists/:id | GET | lists:read | âœ— | âœ— |
| /api/lists/:id | PATCH | lists:update | âœ— | âœ“ |
| /api/lists/:id | DELETE | lists:delete | âœ— | âœ“ |
| /api/lists/:id/leads | POST | lists:update | âœ— | âœ“ |
| /api/lists/:id/leads | DELETE | lists:update | âœ— | âœ“ |
| /api/team | GET | team:read | âœ— | âœ— |
| /api/team/invite | POST | team:invite | âœ— | âœ“ |
| /api/team/invite/:token/accept | POST | Public | âœ— | âœ“ |
| /api/team/:id/role | PATCH | team:change_role | âœ— | âœ“ |
| /api/team/:id | DELETE | team:remove | âœ— | âœ“ |
| /api/audit-logs | GET | audit:read | âœ— | âœ— |

### Sprint 2 APIs
| Endpoint | Method | Permission | Job? | Audit? |
|----------|--------|------------|------|--------|
| /api/jobs | GET | Auth | âœ— | âœ— |
| /api/jobs/:id | GET | Auth | âœ— | âœ— |
| /api/jobs/:id/logs | GET | Auth | âœ— | âœ— |
| /api/jobs/:id/cancel | POST | Auth | âœ— | âœ— |
| /api/search | POST | Auth | âœ“ SEARCH | âœ— |
| /api/search/:jobId/results | GET | Auth | âœ— | âœ— |
| /api/leads/:id/survey | POST | leads:update | âœ“ SURVEY | âœ“ |
| /api/leads/:id/evidence | GET | leads:read | âœ— | âœ— |
| /api/leads/:id/report | GET | leads:read | âœ— | âœ— |

### Sprint 3 APIs
| Endpoint | Method | Permission | Job? | Audit? |
|----------|--------|------------|------|--------|
| /api/whatsapp/send | POST | whatsapp:send | âœ“ WHATSAPP | âœ“ |
| /api/whatsapp/send/bulk | POST | whatsapp:bulk_send | âœ“ WHATSAPP_BULK | âœ“ |
| /api/whatsapp/messages | GET | whatsapp:view_logs | âœ— | âœ— |
| /api/whatsapp/status | GET | Auth | âœ— | âœ— |
| /api/whatsapp/templates | GET | whatsapp:templates | âœ— | âœ— |
| /api/whatsapp/templates | POST | whatsapp:templates | âœ— | âœ“ |
| /api/whatsapp/templates/:id | PATCH | whatsapp:templates | âœ— | âœ“ |
| /api/whatsapp/templates/:id | DELETE | whatsapp:templates | âœ— | âœ“ |
| /api/integrations | GET | integrations:read | âœ— | âœ— |
| /api/integrations/:type/connect | POST | integrations:manage | âœ— | âœ“ |
| /api/integrations/:type/disconnect | POST | integrations:manage | âœ— | âœ“ |
| /api/integrations/:type/sync | POST | integrations:manage | âœ“ SYNC | âœ“ |
| /api/api-keys | GET | api_keys:read | âœ— | âœ— |
| /api/api-keys | POST | api_keys:manage | âœ— | âœ“ |
| /api/api-keys/:id | DELETE | api_keys:manage | âœ— | âœ“ |

### Sprint 4 APIs
| Endpoint | Method | Permission | Job? | Audit? |
|----------|--------|------------|------|--------|
| /api/ai/generate-message | POST | Auth | âœ— | âœ— |
| /api/leads/:id/report/generate | POST | leads:update | âœ“ REPORT | âœ“ |

### Sprint 5 APIs
| Endpoint | Method | Permission | Job? | Audit? |
|----------|--------|------------|------|--------|
| /api/extension/resolve | POST | Auth | âœ— | âœ— |
| /api/extension/reveal | POST | Auth | âœ“ REVEAL | âœ“ |
| /api/extension/save | POST | leads:create | âœ— | âœ“ |
| /api/extension/context | GET | Auth | âœ— | âœ— |
| /api/leads/import | POST | leads:import | âœ“ IMPORT | âœ“ |
| /api/leads/export | POST | leads:export | âœ“ EXPORT | âœ“ |

### Sprint 6 APIs
| Endpoint | Method | Permission | Job? | Audit? |
|----------|--------|------------|------|--------|
| /api/billing/plans | GET | Public | âœ— | âœ— |
| /api/billing/subscription | GET | billing:read | âœ— | âœ— |
| /api/billing/checkout | POST | billing:manage | âœ— | âœ“ |
| /api/billing/portal | POST | billing:manage | âœ— | âœ— |
| /api/billing/usage | GET | billing:read | âœ— | âœ— |

---

## ğŸ› ï¸ Ø§Ù„ØªÙ‚Ù†ÙŠØ§Øª Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…Ø©

### Backend Stack
| Ø§Ù„ØªÙ‚Ù†ÙŠØ© | Ø§Ù„Ø§Ø³ØªØ®Ø¯Ø§Ù… |
|---------|----------|
| Node.js 20 LTS | Runtime |
| NestJS 10 | Framework |
| TypeScript 5 | Language |
| PostgreSQL 16 | Database |
| Prisma 5 | ORM |
| Redis 7 | Cache + Queue |
| BullMQ | Job Queue |
| Socket.io | WebSocket |
| Passport | Auth |
| Zod | Validation |

### External Services
| Ø§Ù„Ø®Ø¯Ù…Ø© | Ø§Ù„Ø§Ø³ØªØ®Ø¯Ø§Ù… |
|--------|----------|
| Google Maps Places API | Search |
| Meta WhatsApp Business API | Messaging |
| OpenAI GPT-4 / Google Gemini | AI |
| Stripe | Billing |
| SendGrid / Resend | Email |
| Sentry | Error Tracking |
| Mixpanel | Analytics |

### DevOps
| Ø§Ù„ØªÙ‚Ù†ÙŠØ© | Ø§Ù„Ø§Ø³ØªØ®Ø¯Ø§Ù… |
|---------|----------|
| Docker | Containerization |
| GitHub Actions | CI/CD |
| AWS / GCP | Cloud |
| Nginx | Reverse Proxy |
| Let's Encrypt | SSL |

---

## ğŸ‘¥ Ø§Ù„ÙØ±ÙŠÙ‚ Ø§Ù„Ù…Ù‚ØªØ±Ø­

| Ø§Ù„Ø¯ÙˆØ± | Ø§Ù„Ø¹Ø¯Ø¯ | Ø§Ù„Ù…Ø¯Ø© | Ø§Ù„Ù…Ù„Ø§Ø­Ø¸Ø§Øª |
|-------|-------|-------|----------|
| Backend Developer (Senior) | 1 | ÙƒØ§Ù…Ù„ | Lead developer |
| Backend Developer (Mid) | 1 | ÙƒØ§Ù…Ù„ | Support |
| Frontend Developer | 1 | Sprint 1+ | Integration |
| DevOps Engineer | 1 | Ø¬Ø²Ø¦ÙŠ | Setup + maintenance |
| QA Engineer | 1 | Sprint 4+ | Testing |
| Product Manager | 1 | ÙƒØ§Ù…Ù„ | Coordination |

---

## ğŸ’° ØªÙ‚Ø¯ÙŠØ± Ø§Ù„ØªÙƒØ§Ù„ÙŠÙ

### ØªÙƒØ§Ù„ÙŠÙ Ø§Ù„ØªØ·ÙˆÙŠØ± (18 Ø£Ø³Ø¨ÙˆØ¹)
| Ø§Ù„Ø¨Ù†Ø¯ | Ø§Ù„ØªÙƒÙ„ÙØ© Ø§Ù„Ø´Ù‡Ø±ÙŠØ© | Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠ (4.5 Ø´Ù‡Ø±) |
|-------|----------------|-------------------|
| Backend Senior | $8,000 | $36,000 |
| Backend Mid | $5,000 | $22,500 |
| Frontend | $5,000 | $22,500 |
| DevOps (Ø¬Ø²Ø¦ÙŠ) | $2,000 | $9,000 |
| QA (Ù…Ù† Sprint 4) | $3,000 | $6,000 |
| PM | $4,000 | $18,000 |
| **Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠ** | | **$114,000** |

### ØªÙƒØ§Ù„ÙŠÙ Ø§Ù„ØªØ´ØºÙŠÙ„ Ø§Ù„Ø´Ù‡Ø±ÙŠØ© (Production)
| Ø§Ù„Ø¨Ù†Ø¯ | Ø§Ù„ØªÙƒÙ„ÙØ© |
|-------|---------|
| Cloud Hosting (AWS/GCP) | $300-500 |
| PostgreSQL (managed) | $100-200 |
| Redis (managed) | $50-100 |
| Google Maps API | $200-1,000 |
| WhatsApp Business API | $100-500 |
| OpenAI/Gemini API | $100-300 |
| Stripe fees | 2.9% + $0.30/tx |
| Monitoring (Sentry) | $50 |
| Email (SendGrid) | $20-50 |
| **Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠ** | **$920-2,700** |

---

## âœ… Ù…Ø¹Ø§ÙŠÙŠØ± Ø§Ù„Ù†Ø¬Ø§Ø­ (Definition of Done)

### Sprint 0
- [ ] Backend project running locally
- [ ] All database tables created
- [ ] Signup creates tenant + owner
- [ ] Login returns JWT with tenant context
- [ ] CI pipeline passing

### Sprint 1
- [ ] Leads CRUD working with tenant scoping
- [ ] Lists CRUD working
- [ ] Team invite flow working
- [ ] RBAC enforced on all endpoints
- [ ] Audit logs recorded

### Sprint 2
- [ ] Job queue processing reliably
- [ ] WebSocket updates working
- [ ] Search returns Google Maps results
- [ ] Survey extracts evidence
- [ ] Frontend connected to job system

### Sprint 3
- [ ] WhatsApp messages sending successfully
- [ ] Delivery status tracked
- [ ] Templates working with variables
- [ ] API keys can authenticate requests
- [ ] Integration connections stored securely

### Sprint 4
- [ ] AI generates quality reports
- [ ] Lead scoring working
- [ ] AI message writing working
- [ ] Response time < 30s for AI calls

### Sprint 5
- [ ] Extension detects LinkedIn/websites
- [ ] Extension saves to CRM
- [ ] Extension uses web auth
- [ ] All error states implemented
- [ ] Performance optimized

### Sprint 6
- [ ] Stripe checkout working
- [ ] Subscription status tracked
- [ ] Usage limits enforced
- [ ] Production deployed
- [ ] Uptime > 99%

---

## âš ï¸ Ø§Ù„Ù…Ø®Ø§Ø·Ø± ÙˆØ§Ù„ØªØ®ÙÙŠÙ

| Ø§Ù„Ù…Ø®Ø§Ø·Ø± | Ø§Ù„Ø§Ø­ØªÙ…Ø§Ù„ÙŠØ© | Ø§Ù„ØªØ£Ø«ÙŠØ± | Ø§Ù„ØªØ®ÙÙŠÙ |
|---------|------------|---------|---------|
| Google Maps API changes | Low | High | Abstract API layer |
| WhatsApp API approval delay | Medium | High | Start process early |
| AI costs higher than expected | Medium | Medium | Caching + prompt optimization |
| Extension review delay | Medium | Low | Submit early |
| Team availability | Medium | High | Document everything |

---

## ğŸ“ Ø§Ù„Ø®Ø·ÙˆØ§Øª Ø§Ù„ØªØ§Ù„ÙŠØ©

1. **Ù…Ø±Ø§Ø¬Ø¹Ø© Ø§Ù„Ø®Ø·Ø©** Ù…Ø¹ Ø§Ù„ÙØ±ÙŠÙ‚
2. **Ø¥Ø¹Ø¯Ø§Ø¯ Ø§Ù„Ø¨ÙŠØ¦Ø©** Ø§Ù„ØªØ·ÙˆÙŠØ±ÙŠØ©
3. **Ø¥Ù†Ø´Ø§Ø¡ Ù…Ø´Ø±ÙˆØ¹ Backend** (NestJS)
4. **Ø¨Ø¯Ø¡ Sprint 0** - Foundation + SaaS

---

> **Ù…Ù„Ø§Ø­Ø¸Ø©:** Ù‡Ø°Ù‡ Ø§Ù„Ø®Ø·Ø© Ù…Ø¨Ù†ÙŠØ© Ø¹Ù„Ù‰ Ø£Ù† Ø§Ù„Ù€ Frontend Prototype Ù…ÙƒØªÙ…Ù„. Ø§Ù„ØªØ±ÙƒÙŠØ² Ø¹Ù„Ù‰ Backend Ù…Ø¹ Ø±Ø¨Ø· ØªØ¯Ø±ÙŠØ¬ÙŠ.
