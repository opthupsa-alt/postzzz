# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# Leedz - Setup for Local Network Testing
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# Ù‡Ø°Ø§ Ø§Ù„Ø³ÙƒØ±Ø¨Øª ÙŠØ¶Ø¨Ø· Ø§Ù„Ù…Ø´Ø±ÙˆØ¹ Ù„Ù„Ø§Ø®ØªØ¨Ø§Ø± Ø¹Ù„Ù‰ Ø§Ù„Ø´Ø¨ÙƒØ© Ø§Ù„Ù…Ø­Ù„ÙŠØ©
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

param(
    [string]$IP = "192.168.20.16"
)

$ErrorActionPreference = "Stop"
$ProjectRoot = Split-Path -Parent $PSScriptRoot

Write-Host ""
Write-Host "â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•" -ForegroundColor Cyan
Write-Host "   ğŸŒ Leedz - Local Network Setup" -ForegroundColor Cyan
Write-Host "â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•" -ForegroundColor Cyan
Write-Host ""
Write-Host "ğŸ“ IP Address: $IP" -ForegroundColor Yellow
Write-Host ""

# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
# ØªØ­Ø¯ÙŠØ« .env.master
# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
$MasterEnvPath = Join-Path $ProjectRoot ".env.master"

if (-not (Test-Path $MasterEnvPath)) {
    Write-Host "âŒ Ù…Ù„Ù .env.master ØºÙŠØ± Ù…ÙˆØ¬ÙˆØ¯!" -ForegroundColor Red
    exit 1
}

Write-Host "ğŸ“ ØªØ­Ø¯ÙŠØ« .env.master..." -ForegroundColor Yellow

# Ù‚Ø±Ø§Ø¡Ø© Ø§Ù„Ù…Ù„Ù Ø§Ù„Ø­Ø§Ù„ÙŠ
$content = Get-Content $MasterEnvPath -Raw

# ØªØ­Ø¯ÙŠØ« Ø£Ùˆ Ø¥Ø¶Ø§ÙØ© HOST_IP
if ($content -match "HOST_IP=") {
    $content = $content -replace "HOST_IP=.*", "HOST_IP=$IP"
} else {
    $content += "`nHOST_IP=$IP"
}

# ØªØ­Ø¯ÙŠØ« Ø£Ùˆ Ø¥Ø¶Ø§ÙØ© API_URL
if ($content -match "API_URL=") {
    $content = $content -replace "API_URL=.*", "API_URL=http://${IP}:3001"
} else {
    $content += "`nAPI_URL=http://${IP}:3001"
}

# ØªØ­Ø¯ÙŠØ« Ø£Ùˆ Ø¥Ø¶Ø§ÙØ© WEB_URL
if ($content -match "WEB_URL=") {
    $content = $content -replace "WEB_URL=.*", "WEB_URL=http://${IP}:3000"
} else {
    $content += "`nWEB_URL=http://${IP}:3000"
}

# Ø­ÙØ¸ Ø§Ù„Ù…Ù„Ù
Set-Content $MasterEnvPath $content -NoNewline
Write-Host "   âœ… .env.master ØªÙ… ØªØ­Ø¯ÙŠØ«Ù‡" -ForegroundColor Green

# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
# ØªØ´ØºÙŠÙ„ sync-and-start.ps1
# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
Write-Host ""
Write-Host "ğŸ”„ ØªØ´ØºÙŠÙ„ Ø§Ù„Ù…Ø²Ø§Ù…Ù†Ø© ÙˆØ§Ù„Ø®Ø¯Ù…Ø§Øª..." -ForegroundColor Yellow
Write-Host ""

$SyncScript = Join-Path $PSScriptRoot "sync-and-start.ps1"
& $SyncScript

Write-Host ""
Write-Host "â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•" -ForegroundColor Green
Write-Host "   âœ… ØªÙ… Ø¶Ø¨Ø· Ø§Ù„Ù…Ø´Ø±ÙˆØ¹ Ù„Ù„Ø´Ø¨ÙƒØ© Ø§Ù„Ù…Ø­Ù„ÙŠØ©!" -ForegroundColor Green
Write-Host "â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•" -ForegroundColor Green
Write-Host ""
Write-Host "ğŸ”— ÙŠÙ…ÙƒÙ† Ø§Ù„ÙˆØµÙˆÙ„ Ù…Ù† Ø£ÙŠ Ø¬Ù‡Ø§Ø² Ø¹Ù„Ù‰ Ø§Ù„Ø´Ø¨ÙƒØ©:" -ForegroundColor Yellow
Write-Host "   â€¢ Frontend: http://${IP}:3000" -ForegroundColor Cyan
Write-Host "   â€¢ Backend:  http://${IP}:3001" -ForegroundColor Cyan
Write-Host ""
Write-Host "ğŸ“± Ù„Ù„Ø§Ø®ØªØ¨Ø§Ø± Ù…Ù† Ø¬Ù‡Ø§Ø² Ø¢Ø®Ø±:" -ForegroundColor Yellow
Write-Host "   1. ØªØ£ÙƒØ¯ Ø£Ù† Ø§Ù„Ø¬Ù‡Ø§Ø² Ø¹Ù„Ù‰ Ù†ÙØ³ Ø§Ù„Ø´Ø¨ÙƒØ©" -ForegroundColor Gray
Write-Host "   2. Ø§ÙØªØ­ http://${IP}:3000 ÙÙŠ Ø§Ù„Ù…ØªØµÙØ­" -ForegroundColor Gray
Write-Host ""
